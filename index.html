<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>بازی مافیا - ورود</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lilita+One&family=Vazirmatn:wght@400;700&display=swap" rel="stylesheet">
    <!-- لینک به فایل استایل مشترک -->
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- کامپوننت‌های مشترک -->
    <div id="user-profile-area" class="hidden">
        <div id="avatar-container" class="hidden" title="تغییر آواتار">
            <img id="avatar-image" src="https://placehold.co/80x80/333333/777777?text=?" alt="آواتار کاربر" onerror="this.src='https://placehold.co/80x80/333333/777777?text=?'">
        </div>
        <div id="user-info-box" class="hidden">
            <div id="display-name-output-box" class="user-info-item">
                <div class="label flex items-center gap-1">
                    <svg xmlns="http://www.w.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" class="text-yellow-300"><path d="M12 2C9.243 2 7 4.243 7 7s2.243 5 5 5 5-2.243 5-5S14.757 2 12 2zm0 8c-1.654 0-3-1.346-3-3s1.346-3 3-3 3 1.346 3 3-1.346 3-3 3zm9 11v-1c0-3.859-3.141-7-7-7h-4c-3.86 0-7 3.141-7 7v1h2v-1c0-2.757 2.243-5 5-5h4c2.757 0 5 2.243 5 5v1h2z"></path></svg>
                    <span>بازیکن:</span>
                </div>
                <div id="display-name-output-container" class="flex items-center gap-2">
                    <span id="edit-name-btn" title="تغییر نام">✏️</span>
                    <div id="display-name-output" class="value clash-font"></div>
                </div>
            </div>
            <div id="public-user-id-output-box" class="user-info-item">
                <div class="label flex items-center gap-1">
                    <svg xmlns="http://www.w.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" class="text-gray-300"><path d="M10.681 5.438 1.48 11.644a1.001 1.001 0 0 0 0 1.503l8.948 6.039a.998.998 0 0 0 1.474-.343l.15-.345-4.437-4.321 4.437-4.321-.15-.345a.998.998 0 0 0-1.221-.574zM22.52 11.644 13.319 5.438a.998.998 0 0 0-1.474.343l-.15.345 4.437 4.321-4.437 4.321.15.345a.998.998 0 0 0 1.474.343l9.201-6.206a1 1 0 0 0 0-1.503z"></path></svg>
                    <span>شناسه:</span>
                </div>
                <div id="public-user-id-output" class="value"></div>
            </div>
        </div>
    </div>

    <!-- صفحه لودینگ -->
    <div id="loading-screen" class="screen active">
        <div id="loading-content-box">
            <img id="loading-logo" src="https://up.20script.ir/file/7e7a-Copilot-20250812-110015-removebg-preview.png" alt="لوگوی بازی شهر مافیا">
            <h1 class="text-4xl sm:text-5xl font-bold clash-font text-[var(--clash-gold)]" style="text-shadow: 3px 3px 4px #000;">شهر مافیا</h1>
            <div id="loading-progress-bar-container">
                <div id="loading-progress-bar-fill"></div>
            </div>
            <p id="loading-message" class="text-lg">در حال آماده سازی...</p>
            <p id="loading-tip">✨ در حال جستجو در آرشیوهای مخفی... ✨</p>
        </div>
    </div>

    <!-- صفحه اصلی (ورود و منو) -->
    <div id="main-screen" class="screen">
        <div class="screen-content-wrapper">
            <div>
                <div id="main-screen-header">
                    <h1 id="main-title" class="clash-font">شهر مافیا</h1>
                </div>
                <div id="auth-panel" class="mb-4 panel-clash panel-visible p-4 sm:p-6 rounded-lg max-w-md mx-auto">
                    <div id="registration-form">
                        <h2 class="text-xl sm:text-2xl font-semibold mb-3 sm:mb-4 text-center clash-font text-[var(--clash-gold)]" style="text-shadow: 2px 2px 2px #000;">ثبت نام</h2>
                        <label for="display-name-input" class="block mb-1">
                            <span class="text-sm font-medium mb-1 inline-block">نام نمایشی (فقط انگلیسی):</span>
                            <input type="text" id="display-name-input" placeholder="نام نمایشی خود را وارد کنید" class="input-clash w-full p-2 sm:p-3 text-base sm:text-lg clash-font" maxlength="20">
                        </label>
                        <p id="input-error-message" class="text-red-400 text-sm mt-1 hidden"></p>
                        <div class="mt-3 mb-2">
                            <label for="user-id-display" class="block text-sm font-medium mb-1">شناسه کاربری (5 رقمی):</label>
                            <div class="flex items-center gap-2">
                                <input type="text" id="user-id-display" class="input-clash w-full p-2 sm:p-3 text-base sm:text-lg text-center" readonly placeholder="بساز!">
                                <button id="generate-user-id-btn" class="btn-clash btn-clash-secondary whitespace-nowrap px-3 py-2 sm:px-4 sm:py-3 text-xs sm:text-sm clash-font">ساخت شناسه</button>
                            </div>
                            <p id="user-id-error-message" class="text-red-400 text-sm mt-1 hidden"></p>
                        </div>
                        <button id="register-btn" class="btn-clash btn-clash-primary w-full p-2 sm:p-3 text-base sm:text-lg mt-4 clash-font">ورود به شهر</button>
                    </div>
                </div>
            </div>
            <div id="main-screen-buttons-layout" class="pb-2 sm:pb-4 hidden">
                <div id="top-action-buttons">
                    <button id="leaderboard-btn" class="btn-clash btn-clash-secondary clash-font">🏆 رتبه‌بندی</button>
                    <button id="start-game-btn" class="btn-clash btn-clash-primary clash-font">شروع بازی</button>
                    <button id="developers-btn" class="btn-clash btn-clash-secondary clash-font">👥 سازندگان</button>
                    <button id="mafia-fact-btn" class="btn-clash btn-clash-secondary clash-font">دانستنی‌ها ✨</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- مدال‌ها و پنل‌ها -->
    <div id="modal-container" class="fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center p-4 panel-hidden z-50">
        <div id="modal-content" class="panel-clash w-full max-w-md p-6 rounded-lg modal-content-animate">
             <!-- محتوا به صورت داینامیک توسط جاوا اسکریپت اضافه می‌شود -->
        </div>
    </div>
    <div id="developers-panel-container" class="fixed inset-0 flex items-center justify-center p-4 panel-hidden z-[51]">
         <div id="developers-panel" class="panel-clash w-full max-w-md p-6 modal-content-animate">
            <h2 class="text-2xl font-bold mb-4 clash-font text-center text-[var(--clash-gold)]">تیم سازنده</h2>
            <p class="text-center">این بازی با ❤️ توسط <strong class="text-lg text-cyan-400">MrBoy</strong> ساخته شده است.</p>
            <button id="close-developers-btn" class="btn-clash btn-clash-secondary w-full mt-6">بازگشت</button>
        </div>
    </div>
    <div id="leaderboard-panel-container" class="fixed inset-0 flex items-center justify-center p-4 panel-hidden z-[51]">
        <div id="leaderboard-panel" class="panel-clash w-full max-w-2xl p-6 modal-content-animate">
            <h2 class="text-2xl font-bold mb-4 clash-font text-center text-[var(--clash-gold)]">🏆 رتبه‌بندی برترین‌ها 🏆</h2>
            <div id="leaderboard-loading" class="text-center">در حال بارگذاری...</div>
            <div id="leaderboard-content" class="hidden">
                <table id="leaderboard-table" class="w-full">
                    <thead><tr><th>رتبه</th><th>نام بازیکن</th><th>مرحله</th></tr></thead>
                    <tbody id="leaderboard-body"></tbody>
                </table>
            </div>
            <button id="close-leaderboard-btn" class="btn-clash btn-clash-secondary w-full mt-6">بازگشت</button>
        </div>
    </div>
    <div id="game-mode-panel-container" class="fixed inset-0 flex items-center justify-center p-4 panel-hidden z-[51]">
        <div id="game-mode-panel" class="panel-clash w-full max-w-md p-6 modal-content-animate">
            <h2 class="text-2xl font-bold mb-4 clash-font text-center text-[var(--clash-gold)]">انتخاب حالت بازی</h2>
            <div class="flex flex-col gap-4">
                <button id="single-player-btn" class="btn-clash btn-clash-primary p-4 text-lg">👤 تک نفره</button>
                <button id="multiplayer-btn" class="btn-clash btn-clash-secondary p-4 text-lg" disabled title="به زودی!">👥 چند نفره (به زودی)</button>
            </div>
            <button id="close-game-mode-btn" class="btn-clash btn-clash-secondary w-full mt-6">انصراف</button>
        </div>
    </div>

    <!-- تگ‌های صوتی -->
    <div id="audio-container" class="hidden">
        <audio id="audio-click" src="https://up.20script.ir/file/6c66-click.mp3" preload="auto"></audio>
        <audio id="audio-correct" src="https://up.20script.ir/file/e62e-correct.mp3" preload="auto"></audio>
        <audio id="audio-wrong" src="https://up.20script.ir/file/2065-wrong.mp3" preload="auto"></audio>
        <audio id="audio-start-game" src="https://up.20script.ir/file/b7cd-start-game.mp3" preload="auto"></audio>
    </div>

    <!-- لینک به فایل‌های جاوا اسکریپت -->
    <script type="module" src="./js/main.js"></script>
</body>
</html>
